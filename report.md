# **Отчет о выполнении Домашнего задания №1**
## *Выполнил* Шатравка Даниил Алексанрович БПИ212
## *Вариант 6*

---
Программа получает строку и выводит сообщение "YES" соответствующим способом, если строка является полиндромом, и "NO" в противном случае.

# На 4 балла
### Привести решение на языке C
Решение представленно в файлах находящихся в [папке](./C_files/):
- [Основной файл](./C_files/main.c)
- [Ввод из файла](./C_files/fileReader.c)
- [Вывод в файл](./C_files/fileWriter.c)
- [Генератор числа](./C_files/doubleGenerator.c)
- [Данная функция](./C_files/function.c)

### Комментарии в ассемблер
В ассемблер-файлах написаны комметарии, представляющие описание комманд ассемблера.
Файлы находится в [папке](./Assembler_files_reg/):
- [Ассемблер-код основного файла](./Assembler_files/main.s)
- [Ассемблер-код ввода из файла](./Assembler_files/fileReader.s)
- [Ассемблер-код вывода в файл](./Assembler_files/fileWriter.s)
- [Ассемблер-код генератора числа](./Assembler_files/randomGenerator.s)
- [Ассемблер-код функции](./Assembler_files/polindromChecker.s)

### Компиляция 
Программа была откомпелированна с помощью флагов:
```
gcc -masm=intel \
    -fno-asynchronous-unwind-tables \
    -fno-jump-tables \
    -fno-stack-protector \
    -fno-exceptions \
    ./code.c \
    -S -o ./code.s
```

Файлы собраны в объектные:

`gcc ./main.c -c -o ./main.o`

Линковка программы:

`gcc -lm ./Object_files/*.o -o ./Executable_files/program -lm`

Для удобства компиляции был написан [bash скрипт](Bash_scripts/compileFromC.sh)

[Итоговый файл](./Executable_files/program)

### Тесты
Тестовое покрытие находится в [папке тестов](./Test/)

Входные данные имеют расширение **.in**

Выходные данные имеют расширение **.out**

Результаты тестовых прогонов совпали с ожидаемыми выходными данными.

---

# На 5 баллов 

## Функции с передачей данных:
в программе реализовано 4 функции с передачей данных:
```
doubleGenerator(double *x);
function(double *x);
ReadFromFile(char* filename, double *to_write);
WriteToFile(char* filename, double *to_write);
```

## Локальные переменные
В коде функций используются локальные переменные:

```
// main
clock_t timer;
double x;
char *input_file, *output_file;
// file writter readers
FILE* file
```

## Передача параметров
В комментариях к [ассемблер-файлам](#комментарии-в-ассемблер) добавлена информация о передаче параметров через регистры.

---

# На 6 баллов
## Использование регистров процессора
Переменные, которые раньше находились на стеке, перемещены на регистры процессора.

### Изменения в main.s

Переменая *timer*
` QWORD PTR -24[rbp] -> r12`

Данное изменение уменьшит количество запросов на стек, что уменьшит время работы программы.

Тестовые прогоны совпадают с рузультатами тестовых прогонов до выполнения рефакторинга.

### Изменение размера 
$ 2232 kb => 2228 kb$     

Замер производился с помощью команды `command time -v ./Executable_files/program`

# На 7 баллов

### Единицы компиляции
Программа скомпилирована с использованим [5 единиц компиляции](#комментарии-в-ассемблер).

### Задание файла с входными и выходными данными
Для работы с файлами нужно передать из имена в командную строку при запуске.

Если передан один параметр, то вывод будет выполнен в файл, а число сгенерируется случайно. 

# На 8 баллов
## Использование генератора случайных значений
Генератор случайных значений представлен в [файле генераторе](./C_files/doubleGenerator.c).

Для активации генератора, нужно запустить программу без аргументов или с одним аргументом.

# Замеры времени работы программы

После выполнения программа выводит количество миллисекунд, которое заняло выполнение программы (Учитывалась только функция).

Среднее время работы программы: **7 ms**


# На 9 баллов

Вариации программы находятся [здесь](./Optimithations/).

| Параметр оптимизации     | Время работы, ms  | Занимаемая память, kb|
| :---        |    :----:   |   :----: |
| O0      | 8 | 1032    |
| O1 | 7  |   960 |
| O2  | 7 | 912 |
| O3  | 7 |   948   |
| Ofast  | 6 |   1016   |
| Os  | 11 |  1060   |
